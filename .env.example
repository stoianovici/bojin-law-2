# Legal Platform - Local Development
# Copy to .env.local and fill in your values
#
# Setup:
#   1. docker compose up -d
#   2. cp .env.example .env.local
#   3. Fill in Azure AD + Anthropic values below
#   4. pnpm dev

# =============================================================================
# REQUIRED - Database & Cache (provided by docker compose)
# =============================================================================
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/legal_platform_prod
REDIS_URL=redis://localhost:6379

# =============================================================================
# OPTIONAL - Production Database (for mirror:prod data sync)
# =============================================================================
# Get from: Render Dashboard > legal-platform-db > Connections > External URL
PROD_DATABASE_URL=

# =============================================================================
# REQUIRED - Azure AD Authentication
# Get from: Azure Portal > App Registrations > Your App > Overview
# =============================================================================
# Client ID (also called Application ID)
AZURE_AD_CLIENT_ID=
NEXT_PUBLIC_AZURE_AD_CLIENT_ID=

# Tenant ID (also called Directory ID)
AZURE_AD_TENANT_ID=
NEXT_PUBLIC_AZURE_AD_TENANT_ID=

# Client Secret - Azure Portal > Certificates & secrets > New client secret
AZURE_AD_CLIENT_SECRET=

# =============================================================================
# REQUIRED - AI (Anthropic Claude)
# Get from: console.anthropic.com > API Keys
# =============================================================================
ANTHROPIC_API_KEY=
# Admin API key for usage/cost reporting (optional, starts with sk-ant-admin)
# Get from: console.anthropic.com > Settings > Admin Keys (requires admin role)
ANTHROPIC_ADMIN_API_KEY=

# OAuth redirect URI (must match Azure AD app registration)
AZURE_AD_REDIRECT_URI=http://localhost:4000/auth/callback

# =============================================================================
# OPTIONAL - SharePoint Integration
# Get from: SharePoint Admin Center or Microsoft Graph Explorer
# =============================================================================
# Site ID format: hostname,site-guid,web-guid (e.g., contoso.sharepoint.com,guid1,guid2)
SHAREPOINT_SITE_ID=
# Drive ID for the document library (e.g., b!xxxxxxxxxxxx)
SHAREPOINT_DRIVE_ID=

# =============================================================================
# OPTIONAL - AI Service Configuration
# =============================================================================
# Service-to-service authentication key
AI_SERVICE_API_KEY=local-dev-ai-service-key
# Claude model to use
ANTHROPIC_MODEL=claude-sonnet-4-20250514
# Max tokens for responses
ANTHROPIC_MAX_TOKENS=4096

# =============================================================================
# OPTIONAL - Web Search (for AI research documents)
# Get from: https://brave.com/search/api/ (first 2000 queries/month free)
# =============================================================================
BRAVE_SEARCH_API_KEY=

# =============================================================================
# OPTIONAL - Defaults work for local dev
# =============================================================================
NEXT_PUBLIC_API_URL=http://localhost:4000/graphql
FRONTEND_URL=http://localhost:3000
JWT_SECRET=dev-secret-change-in-production
SESSION_SECRET=dev-session-secret-change-in-production

# Gateway port (default: 4000)
PORT=4000

# =============================================================================
# OPTIONAL - R2 Storage (Cloudflare)
# Get from: Cloudflare Dashboard > R2 > Manage R2 API Tokens
# =============================================================================
R2_ACCOUNT_ID=
R2_ACCESS_KEY_ID=
R2_SECRET_ACCESS_KEY=
R2_ENDPOINT=
R2_BUCKET_NAME=legal-documents

# =============================================================================
# OPTIONAL - Render (deployment API)
# Get from: Render Dashboard > Account Settings > API Keys
# =============================================================================
RENDER_API_KEY=

# =============================================================================
# OPTIONAL - CORS Origins
# Comma-separated list of allowed origins for the gateway
# =============================================================================
CORS_ORIGIN=http://localhost:3000,http://localhost:3001,https://localhost:3005

# =============================================================================
# OPTIONAL - Word Add-in Dev Bypass (LOCAL DEVELOPMENT ONLY!)
# =============================================================================
# WARNING: NEVER enable in production! This bypasses authentication entirely.
# The code automatically blocks this when NODE_ENV=production, but setting
# this to 'true' in production configs is a security misconfiguration.
#
# Set to 'true' ONLY for local development without Azure AD SSO configured
ENABLE_DEV_BYPASS=false
# Your firm ID from the database - required when ENABLE_DEV_BYPASS=true
# Get from: SELECT id FROM "Firm" LIMIT 1; (or use your actual firm ID)
DEV_BYPASS_FIRM_ID=

# =============================================================================
# OPTIONAL - Word AI Rate Limiting
# =============================================================================
# Streaming endpoint rate limit (10 requests per 5 minutes by default)
WORD_AI_STREAMING_RATE_LIMIT_REQUESTS=10
WORD_AI_STREAMING_RATE_LIMIT_WINDOW=300

# =============================================================================
# OPTIONAL - Word AI Input Validation Limits
# =============================================================================
# These limits protect against oversized requests and potential DoS attacks.
# Defaults are reasonable for most use cases. Adjust only if needed.
#
# Maximum document name length (default: 200 bytes)
# WORD_AI_MAX_DOCUMENT_NAME_LENGTH=200
#
# Maximum prompt length (default: 50KB)
# WORD_AI_MAX_PROMPT_LENGTH=51200
#
# Maximum existing content length (default: 500KB)
# WORD_AI_MAX_EXISTING_CONTENT_LENGTH=512000
#
# Maximum text length for analysis (default: 100KB)
# WORD_AI_MAX_TEXT_LENGTH=102400
#
# Maximum instruction length (default: 10KB)
# WORD_AI_MAX_INSTRUCTION_LENGTH=10240
#
# Maximum required sections for validation (default: 50)
# WORD_AI_MAX_REQUIRED_SECTIONS=50
#
# Maximum section name length (default: 100)
# WORD_AI_MAX_SECTION_NAME_LENGTH=100
#
# Maximum request body size (default: 5MB)
# WORD_AI_MAX_BODY_SIZE=5242880
