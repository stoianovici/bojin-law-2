# OPS-297: Touch Gesture Support (Optional Enhancement)

**Type**: Feature | **Priority**: P2-Medium | **Complexity**: M

## Problem

Mobile users expect native-feeling swipe gestures: swipe right from left edge to open drawer, swipe left to close. Without gestures, users must tap the small hamburger button.

## Solution

Add touch gesture detection for natural mobile interaction:

- Detect swipe from left edge (0-20px starting position) → open drawer
- Detect swipe left when drawer is open → close drawer
- Use native touch events: `touchstart`, `touchmove`, `touchend`
- Threshold: 50px horizontal swipe distance to trigger

## Implementation

### Option A: Custom hook (lightweight)

```tsx
// hooks/useTouchDrawer.ts
export function useTouchDrawer(isOpen: boolean, onToggle: () => void) {
  const touchStartX = useRef(0);
  const touchStartY = useRef(0);

  useEffect(() => {
    const handleTouchStart = (e: TouchEvent) => {
      touchStartX.current = e.touches[0].clientX;
      touchStartY.current = e.touches[0].clientY;
    };

    const handleTouchEnd = (e: TouchEvent) => {
      const touchEndX = e.changedTouches[0].clientX;
      const touchEndY = e.changedTouches[0].clientY;

      const deltaX = touchEndX - touchStartX.current;
      const deltaY = Math.abs(touchEndY - touchStartY.current);

      // Ignore vertical swipes (scrolling)
      if (deltaY > Math.abs(deltaX)) return;

      // Swipe right from left edge to open
      if (!isOpen && touchStartX.current < 20 && deltaX > 50) {
        onToggle();
      }

      // Swipe left to close when open
      if (isOpen && deltaX < -50) {
        onToggle();
      }
    };

    document.addEventListener('touchstart', handleTouchStart);
    document.addEventListener('touchend', handleTouchEnd);

    return () => {
      document.removeEventListener('touchstart', handleTouchStart);
      document.removeEventListener('touchend', handleTouchEnd);
    };
  }, [isOpen, onToggle]);
}
```

### Option B: Use react-swipeable library

```tsx
import { useSwipeable } from 'react-swipeable';

const handlers = useSwipeable({
  onSwipedRight: () => !isOpen && toggleSidebar(),
  onSwipedLeft: () => isOpen && toggleSidebar(),
  trackMouse: false,
  delta: 50,
});

// Apply to a wrapper div
<div {...handlers}>
```

### Integration in Sidebar.tsx or MainLayout.tsx

```tsx
// In MainLayout.tsx
useTouchDrawer(!isSidebarCollapsed, toggleSidebar);
```

## Done When

- [ ] Swipe from left edge (0-20px) opens drawer
- [ ] Swipe left anywhere when drawer open closes it
- [ ] Works on iOS Safari
- [ ] Works on Chrome Android
- [ ] No conflict with horizontal scroll content
- [ ] No conflict with vertical scrolling

## Files

- `apps/web/src/hooks/useTouchDrawer.ts` (new)
- `apps/web/src/components/layout/MainLayout.tsx` - integrate hook

## Testing

1. Test on actual mobile device or Chrome DevTools with touch simulation
2. Swipe from left edge - drawer opens
3. Swipe left on drawer - drawer closes
4. Scroll vertically on content - should NOT trigger drawer
5. Horizontal scroll components (if any) - should NOT trigger drawer

## Dependencies

- OPS-296: Mobile Drawer State Behavior (drawer must work first)

## Blocked By

- OPS-296

## Blocks

None - this is an enhancement

## Notes

This is an optional enhancement. The core mobile experience (OPS-294, 295, 296) works without gestures. Users can always use the hamburger button. Add gestures only if the hamburger interaction feels clunky in real usage.
