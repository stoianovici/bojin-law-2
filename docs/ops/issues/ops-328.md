# OPS-328: Mobile Page Consistency

**Status**: Complete
**Priority**: P2-Medium
**Type**: Feature
**Platform**: Mobile
**Parent**: OPS-322
**Blocked by**: OPS-324 (now complete)

---

## Problem Statement

Mobile pages need to consistently use the polished mobile components (from OPS-324) and Linear styling. Some pages may still use desktop components or have inconsistent mobile layouts.

---

## Approach

### Mobile-Specific Pages to Review

1. **Home/Dashboard**
   - Uses `MobileHome` component
   - Masthead with date and avatar
   - Morning briefing section
   - Cases horizontal scroll
   - Tasks list
   - Activity feed

2. **Cases Page**
   - Tab bar highlights "Dosare"
   - Case list optimized for touch
   - Search/filter accessible

3. **Tasks Page**
   - Tab bar highlights "Sarcini"
   - Task checkboxes are touch-friendly
   - Swipe actions (if applicable)

4. **Calendar Page**
   - Tab bar highlights "Calendar"
   - Mobile-friendly calendar view

### Layout Integration

```tsx
// ConditionalLayout should handle:
// - isMobile detection
// - Render MobileTabBar for mobile
// - Render Sidebar for desktop
// - Show/hide FAB appropriately
```

### Responsive Breakpoints

```css
/* Mobile: < 768px */
@media (max-width: 767px) {
  /* Mobile layout */
}

/* Tablet: 768px - 1024px */
@media (min-width: 768px) and (max-width: 1024px) {
  /* Tablet layout - may use mobile or desktop */
}

/* Desktop: > 1024px */
@media (min-width: 1025px) {
  /* Desktop layout */
}
```

---

## Acceptance Criteria

- [x] Mobile home page matches mockup exactly
- [x] All tab bar pages styled consistently
- [x] Tab bar highlights correct page on navigation
- [x] Drawer navigation works smoothly
- [x] Pull-to-refresh styled correctly (if implemented)
- [x] FAB appears on appropriate pages
- [x] No desktop components showing on mobile
- [x] Responsive breakpoints work correctly

---

## Key Files

- `apps/web/src/app/page.tsx` (mobile home)
- `apps/web/src/app/cases/page.tsx` (mobile cases)
- `apps/web/src/app/tasks/page.tsx` (mobile tasks)
- `apps/web/src/components/layout/ConditionalLayout.tsx`
- `apps/web/src/components/mobile/*`
- `apps/web/src/hooks/useIsMobile.ts`

---

## Notes

- This is blocked by OPS-324 (Mobile Component Polish)
- Test on real mobile device or Chrome DevTools
- Verify no layout shift when switching between pages
- Tab bar should persist across page navigation

---

## Investigation Notes (2025-12-28)

### Current State Assessment

**What's Working:**

- ✅ Home page (`/`) - Uses dedicated `MobileHome` component with proper mobile UX
- ✅ Tab bar highlighting - Working correctly on all pages (verified via DOM inspection)
- ✅ Drawer navigation - Working with Linear tokens
- ✅ FAB - Appears correctly above tab bar
- ✅ Global mobile layout - `ConditionalLayout` properly renders MobileTabBar + FAB + Sheet

**Issues Found:**

| Page              | Issue                                            | Severity |
| ----------------- | ------------------------------------------------ | -------- |
| `/cases`          | Uses desktop layout (PageLayout + CaseListTable) | Medium   |
| `/tasks`          | Desktop calendar view, hard to use on mobile     | High     |
| `/documents`      | Two-panel layout overlaps on mobile              | High     |
| `/communications` | Two-panel layout overlaps on mobile              | High     |

### Architecture Analysis

The app uses `useIsMobile()` hook for mobile detection. The pattern used in `/page.tsx` (Home) is:

```tsx
if (isMobile) {
  return <MobileHome />;
}
// else render desktop
```

Other pages (`/cases`, `/tasks`, etc.) do NOT have this pattern - they always render desktop components.

### Options for Resolution

1. **Quick CSS Fixes** (Low effort)
   - Reduce padding on mobile
   - Stack two-panel layouts vertically
   - Improve touch target sizes
   - ~2-3 hours

2. **Responsive Page Components** (Medium effort)
   - Add responsive breakpoints to existing components
   - Hide secondary panels on mobile
   - Optimize grid layouts for mobile
   - ~4-6 hours

3. **Dedicated Mobile Pages** (High effort)
   - Create `MobileCases`, `MobileTasks`, etc. components
   - Match the MobileHome experience
   - Full mobile-first design
   - ~2-3 days

### Implementation (Option 3 Selected)

User selected Option 3: Dedicated Mobile Pages. Created mobile-optimized components for all tab bar pages:

#### New Components Created

1. **MobileCases** (`apps/web/src/components/mobile/MobileCases.tsx`)
   - Mobile-optimized case list with search bar and filter buttons
   - Touch-friendly case cards with status badges
   - Pull-to-refresh support
   - Case count display

2. **MobileTasks** (`apps/web/src/components/mobile/MobileTasks.tsx`)
   - Date-grouped task list (Întârziate, Astăzi, Mâine, Săptămâna aceasta, Mai târziu)
   - Filter tabs (De făcut, Finalizate, Toate)
   - Task items with checkboxes, priority, due dates/times
   - Pull-to-refresh support

3. **MobileDocuments** (`apps/web/src/components/mobile/MobileDocuments.tsx`)
   - Two-view navigation pattern
   - Case selection view → Document list view
   - Back navigation between views
   - Document items with file type icons

4. **MobileCommunications** (`apps/web/src/components/mobile/MobileCommunications.tsx`)
   - Two-view navigation pattern
   - Unclear messages section for items needing attention
   - Case-grouped email threads
   - Unread count badges

#### Page Files Updated

- `apps/web/src/app/cases/page.tsx` - Added `useIsMobile()` check, renders `MobileCases` on mobile
- `apps/web/src/app/tasks/page.tsx` - Added `useIsMobile()` check, renders `MobileTasks` on mobile
- `apps/web/src/app/documents/page.tsx` - Added `useIsMobile()` check, renders `MobileDocuments` on mobile
- `apps/web/src/app/communications/page.tsx` - Added `useIsMobile()` check, renders `MobileCommunications` on mobile

#### Verification

All mobile pages tested at 390x844 viewport:

- ✅ MobileCases - Full case list with search, filters, cards
- ✅ MobileTasks - Date-grouped task list with filter tabs
- ✅ MobileDocuments - Two-view case selection pattern
- ✅ MobileCommunications - Two-view with unclear messages section
- ✅ Tab bar highlighting works on all pages
- ✅ FAB appears correctly on all pages
