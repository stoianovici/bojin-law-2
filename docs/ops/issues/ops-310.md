# OPS-310: MobileBriefing Component

**Type**: Feature | **Priority**: P1-High | **Platform**: Mobile
**Status**: Completed
**Parallel**: Yes (Phase 1)

## Problem

Desktop `MorningBriefing` component is card-based with collapsible sections - too heavy for mobile. Need a lightweight, typography-first adaptation that matches the newspaper-style design language.

## Approach

Create `MobileBriefing` component that:

- Uses `useMorningBriefing()` hook (already exists)
- Shows AI summary as highlighted text block at top
- Displays key deadlines inline (no collapsible)
- Shows prioritized tasks as compact list (title + due date)
- Risk alerts shown only if high severity
- Minimal chrome, newspaper-style typography (matches BriefRow pattern)
- Loading skeleton similar to BriefRowSkeleton

## Implementation

```tsx
// apps/web/src/components/mobile/MobileBriefing.tsx

'use client';

import React from 'react';
import { useMorningBriefing } from '../../hooks/useMorningBriefing';
import { AlertTriangle, Clock, Sparkles } from 'lucide-react';
import { formatDistanceToNow } from 'date-fns';
import { ro } from 'date-fns/locale';

export function MobileBriefing() {
  const {
    briefing,
    loading,
    error,
    hasBriefing,
    summary,
    prioritizedTasks,
    keyDeadlines,
    riskAlerts,
  } = useMorningBriefing();

  if (loading) {
    return <MobileBriefingSkeleton />;
  }

  if (error || !hasBriefing) {
    return null; // Graceful degradation - show feed instead
  }

  const highRiskAlerts = riskAlerts.filter((a) => a.severity === 'high');

  return (
    <div className="px-4 py-3 space-y-4">
      {/* AI Summary Block */}
      {summary && (
        <div className="bg-blue-50 border-l-4 border-blue-500 p-3 rounded-r-lg">
          <div className="flex items-start gap-2">
            <Sparkles className="w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0" />
            <p className="text-[15px] text-gray-800 leading-relaxed">{summary}</p>
          </div>
        </div>
      )}

      {/* Key Deadlines */}
      {keyDeadlines.length > 0 && (
        <div>
          <h3 className="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">
            Termene
          </h3>
          <div className="space-y-2">
            {keyDeadlines.slice(0, 3).map((deadline, i) => (
              <div key={deadline.id || i} className="flex items-center gap-2">
                <Clock
                  className={`w-4 h-4 flex-shrink-0 ${
                    deadline.severity === 'critical' ? 'text-red-500' : 'text-orange-500'
                  }`}
                />
                <span className="text-[15px] text-gray-900 flex-1">{deadline.title}</span>
                <span
                  className={`text-sm font-medium ${
                    deadline.daysUntilDue <= 0
                      ? 'text-red-600'
                      : deadline.daysUntilDue <= 1
                        ? 'text-orange-600'
                        : 'text-gray-500'
                  }`}
                >
                  {deadline.daysUntilDue <= 0
                    ? 'Depasit'
                    : deadline.daysUntilDue === 1
                      ? 'Maine'
                      : `${deadline.daysUntilDue} zile`}
                </span>
              </div>
            ))}
          </div>
        </div>
      )}

      {/* High Risk Alerts */}
      {highRiskAlerts.length > 0 && (
        <div className="bg-red-50 border border-red-200 rounded-lg p-3">
          <div className="flex items-start gap-2">
            <AlertTriangle className="w-4 h-4 text-red-600 mt-0.5 flex-shrink-0" />
            <div>
              <p className="text-sm font-medium text-red-800">{highRiskAlerts[0].type}</p>
              <p className="text-sm text-red-700 mt-0.5">{highRiskAlerts[0].description}</p>
            </div>
          </div>
        </div>
      )}

      {/* Prioritized Tasks */}
      {prioritizedTasks.length > 0 && (
        <div>
          <h3 className="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">
            De facut azi
          </h3>
          <div className="space-y-1.5">
            {prioritizedTasks.slice(0, 5).map((pt) => (
              <div key={pt.taskId} className="flex items-baseline gap-2">
                <span className="w-1.5 h-1.5 rounded-full bg-blue-500 flex-shrink-0 mt-2" />
                <span className="text-[15px] text-gray-900">{pt.task?.title}</span>
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  );
}

function MobileBriefingSkeleton() {
  return (
    <div className="px-4 py-3 space-y-4 animate-pulse">
      <div className="bg-gray-100 h-20 rounded-lg" />
      <div className="space-y-2">
        <div className="bg-gray-100 h-4 w-20 rounded" />
        <div className="bg-gray-100 h-5 w-full rounded" />
        <div className="bg-gray-100 h-5 w-3/4 rounded" />
      </div>
    </div>
  );
}
```

## Done When

- [x] Component fetches and displays morning briefing
- [x] AI summary shown prominently at top with blue accent
- [x] Deadlines displayed with severity-based colors
- [x] Risk alerts visible for high severity only
- [x] Prioritized tasks shown as bullet list
- [x] Loading skeleton matches mobile design
- [x] Typography consistent with MobileHome (15-17px body)

## Files

- `apps/web/src/components/mobile/MobileBriefing.tsx` - new
- `apps/web/src/components/mobile/index.ts` - add export

## Dependencies

- `useMorningBriefing` hook (exists)
- OPS-238 (Morning Briefings batch job) - completed
