# OPS-278: Timesheet Export (PDF/Clipboard)

**Type**: Feature
**Priority**: P1-High
**Status**: Closed
**Blocked By**: OPS-274, OPS-275 (completed)

## Problem

Partners need to attach timesheets to invoices sent to clients. Currently must manually compile and format time entries.

## Solution

Export timesheet as PDF for printing/email attachment, or copy to clipboard for pasting into Word/Excel.

## Implementation

1. Create `TimesheetExport.tsx` - export button group in header:
   - "Exportă PDF" primary button
   - "Copiază" secondary button
2. PDF Export ("Exportă PDF"):
   - Use `@react-pdf/renderer` library
   - Generate professional PDF with:
     - Header: firm logo (optional), case name, client name, period
     - Contract info: type, hourly rate (if applicable)
     - Table: date, description, hours, cost (if hourly)
     - Team member column (if attribution toggle ON)
     - Totals row
     - Footer: generation date, page numbers
   - Trigger download: `Fisa-pontaj-{CaseName}-{Month-Year}.pdf`
3. Clipboard Export ("Copiază"):
   - Format table as tab-separated values (TSV)
   - Works when pasted into Excel, Word, Google Sheets
   - Include headers row
   - Copy via `navigator.clipboard.writeText()`
   - Show toast: "Copiat în clipboard"
4. Create `apps/web/src/utils/timesheet-pdf.ts`:
   - PDF document component
   - Styles for table, headers, totals
5. Create `apps/web/src/utils/timesheet-clipboard.ts`:
   - TSV formatting function
6. Respect settings in export:
   - Team attribution toggle (OPS-276)
   - Merged rows (OPS-277)
   - Exclude non-billable or mark clearly

## Done When

- [ ] "Exportă PDF" button generates downloadable PDF
- [ ] PDF includes case name, client, period, contract type
- [ ] PDF table matches timesheet view
- [ ] PDF respects team attribution toggle
- [ ] PDF includes merged rows correctly
- [ ] "Copiază" copies TSV to clipboard
- [ ] Clipboard data pastes correctly into Excel/Word
- [ ] Toast confirms clipboard copy
- [ ] Non-billable entries handled (excluded or marked)

## Files

- `apps/web/src/components/team-activity/TimesheetExport.tsx` - export UI
- `apps/web/src/utils/timesheet-pdf.ts` - PDF generation
- `apps/web/src/utils/timesheet-clipboard.ts` - clipboard formatting
- `apps/web/package.json` - add @react-pdf/renderer

## Technical Notes

- `@react-pdf/renderer` is a React-based PDF library
- Alternative: `jspdf` + `jspdf-autotable` for simpler setup
- PDF should be A4 portrait orientation
- Consider adding Excel export (.xlsx) in future
- Clipboard API requires HTTPS in production

## PDF Layout

```
┌─────────────────────────────────────────────────┐
│  [LOGO]                                         │
│                                                 │
│  FIȘĂ DE PONTAJ                                │
│  Dosar: Ionescu SRL vs. Popescu                │
│  Client: Ionescu SRL                           │
│  Perioada: Decembrie 2025                       │
│  Contract: Orar · 350 RON/oră                  │
│                                                 │
│  ┌────────┬─────────────────────┬──────┬──────┐│
│  │ Data   │ Descriere           │ Ore  │ Cost ││
│  ├────────┼─────────────────────┼──────┼──────┤│
│  │ 03.12  │ Cercetare...        │ 2.5  │ 875  ││
│  │ 05.12  │ Redactare...        │ 4.0  │ 1400 ││
│  │ ...    │ ...                 │ ...  │ ...  ││
│  ├────────┼─────────────────────┼──────┼──────┤│
│  │        │ TOTAL               │ 10.0 │ 3500 ││
│  └────────┴─────────────────────┴──────┴──────┘│
│                                                 │
│  Generat: 27.12.2025              Pagina 1/1   │
└─────────────────────────────────────────────────┘
```

## UI Text (Romanian)

- Primary button: "Exportă PDF"
- Secondary button: "Copiază"
- Toast: "Copiat în clipboard"
- PDF title: "FIȘĂ DE PONTAJ"
- PDF labels: "Dosar", "Client", "Perioada", "Contract"
- PDF total: "TOTAL"
- PDF footer: "Generat: {date}"
