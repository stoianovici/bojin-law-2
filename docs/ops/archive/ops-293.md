# OPS-293: Add Outlook Folders Section to CaseSidebar

**Type**: UI | **Priority**: P1-High | **Complexity**: M
**Status**: Closed
**Blocked by**: OPS-290, OPS-292 (both completed)
**Epic**: Sync All Outlook Folders

## Problem

Unassigned emails in user-created Outlook folders need to be visible in /comms without any AI processing - just display.

## Approach

1. Add `OutlookFoldersSection` between DOSARE and INSTANȚE
2. Fetch data via new `emailsByFolder` query
3. Collapsible folder list with email counts
4. Click folder → expands to show emails in card view
5. Click email → opens detail panel (card view, not bubbles)
6. Manual "Assign to case" action available
7. **No AI classification or cleaning runs** - email stays raw until assigned

## Display Position

```
┌─────────────────────────┐
│ DOSARE (Cases)          │  ← Processed, bubbles
├─────────────────────────┤
│ FOLDERE OUTLOOK         │  ← NEW SECTION
│   ├── Clients (12)      │
│   ├── Archive (45)      │
│   └── Projects (8)      │
├─────────────────────────┤
│ INSTANȚE (Court)        │  ← Unprocessed, cards
├─────────────────────────┤
│ NECLAR (Uncertain)      │  ← Unprocessed, cards
└─────────────────────────┘
```

## Done When

- [x] Section appears between DOSARE and INSTANȚE
- [x] Shows folders with unassigned email counts
- [x] Folders expandable/collapsible
- [x] Emails displayed in card view (not bubbles)
- [ ] Assign to case action works (currently logs to console)
- [ ] Processing triggers only on case assignment
- [x] Clear visual distinction from case emails
- [x] Romanian labels (FOLDERE OUTLOOK)

## Files

- `apps/web/src/hooks/useEmailsByFolder.ts` (new)
- `apps/web/src/components/communication/CaseSidebar.tsx` (modified)
- `apps/web/src/app/communications/page.tsx` (modified)
- `apps/web/src/components/communication/OutlookFoldersSection.tsx` (from OPS-290)
- `apps/web/src/components/communication/OutlookFolderEmailItem.tsx` (from OPS-290)
- `apps/web/src/components/communication/FolderEmailsPanel.tsx` (from OPS-290)

## Technical Notes

Follow existing patterns:

- Use `SectionHeader` component with Folder icon
- Use `listItemVariants` for animations
- Add to `collapsedSections` state
- Hook into existing selection state

## Implementation Summary

### 2025-12-27 - Core Implementation Complete

1. **Created `useEmailsByFolder` hook**
   - Fetches emails grouped by Outlook folder via GraphQL
   - Uses `emailsByFolder` query from OPS-292
   - Returns folder data with nested emails

2. **Updated CaseSidebar**
   - Added `outlookFolders` prop for folder data
   - Added `onSelectFolderEmail` and `onAssignFolderEmailToCase` callbacks
   - Renders `OutlookFoldersSection` between DOSARE and INSTANȚE
   - Section only shows when there are folders with emails

3. **Updated Communications Page**
   - Added `folder-email` view mode
   - Added folder email selection handler
   - Added folder email detail view in main panel
   - Refetches folder data after sync

## Session Log

- 2025-12-27: Issue created as part of Outlook Folders epic
- 2025-12-27: Core implementation complete, moved to Verifying status
