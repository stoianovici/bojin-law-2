# OPS-223: Actor Type Selection UI

**Type**: Feature | **Priority**: P2-Medium | **Complexity**: M
**Status**: ✅ Completed

## Problem

ContactsSection and new case page use hardcoded ACTOR_ROLES array. Need to use dynamic types from hook and allow Partners to create custom types inline.

## Solution

Replace hardcoded arrays with useActorTypes hook. Add "+ Tip nou" inline form for Partners following CaseDetailsSection pattern. When custom type selected, populate `customRoleCode` field; when built-in selected, use `role` enum field.

## UI Design

### Role Dropdown

- Flat list (no grouping)
- Built-in types first (sorted by sortOrder)
- Custom types after (sorted by sortOrder)
- Shows Romanian labels

### "+ Tip nou" Button (Partners only)

- Appears next to role dropdown
- Expands inline form when clicked

### Inline Form

```
┌─────────────────────────────────────────────────────┐
│ Nume tip *              │ Cod (auto)                │
│ [____________________]  │ [____________________]    │
│                                                     │
│                         [Anulează]  [Salvează]      │
└─────────────────────────────────────────────────────┘
```

- Name: Free text input (2-100 chars)
- Code: Auto-generated from name (uppercase, no diacritics, underscores)
- Code is editable but auto-updates as name changes
- Save button shows loading spinner during mutation

### Selection Logic

```typescript
// When selecting a role:
if (selectedType.isBuiltIn) {
  actor.role = selectedType.code; // Use enum field
  actor.customRoleCode = null;
} else {
  actor.role = 'Other'; // Fallback enum value
  actor.customRoleCode = selectedType.code;
}
```

## Implementation

1. Update ContactsSection to use useActorTypes hook
2. Update new case page actor role selection
3. Add "+ Tip nou" button visibility check (isPartner)
4. Add inline form with name/code inputs
5. Add auto-code generation effect (same as case types)
6. Handle form submission with createActorType
7. Auto-select new type after creation
8. Update InlineContactCard to display custom role names

## Done When

- [x] ContactsSection uses useActorTypes hook for role dropdown
- [x] New case page uses useActorTypes for actor role selection
- [x] "+ Tip nou" button visible for Partners only
- [x] Inline form with name input and auto-generated code
- [x] Code auto-generation: uppercase, remove diacritics, spaces → underscores
- [x] New custom type auto-selected after creation
- [x] InlineContactCard displays custom role names correctly
- [x] Built-in types use `role` enum, custom types use `customRoleCode`

## Files to Modify

- `apps/web/src/components/case/sections/ContactsSection.tsx` - Dynamic types + add form
- `apps/web/src/app/cases/new/page.tsx` - Dynamic types + add form
- `apps/web/src/components/case/InlineContactCard.tsx` - Display custom role names

## Dependencies

- OPS-219 (expanded enum for built-in types)
- OPS-222 (useActorTypes hook)

## Epic

Court Case Number + Dynamic Actor Types (OPS-218 to OPS-223)
