# OPS-289: Add Folder List Fetching to Graph Service

**Type**: Service | **Priority**: P1-High | **Complexity**: S
**Status**: Verifying
**Parallel**: Yes (Phase 1)
**Epic**: Sync All Outlook Folders

## Problem

Need to fetch user's mail folders from Graph API to map folder IDs to display names during sync.

## Approach

Add method to GraphService:

```typescript
async getMailFolders(accessToken: string, includeChildren?: boolean): Promise<MailFolder[]>
```

Fetches from `/me/mailFolders` endpoint. Returns folder ID, displayName, and childFolderCount.
Recursively fetches child folders when `includeChildren` is true (default).

## Done When

- [x] `getMailFolders()` method added to GraphService
- [x] Includes child folders (recursive fetch if needed)
- [x] Endpoint added to graph.config.ts
- [ ] Unit tests added (skipping for now, will add integration test with real Graph API)

## Files

- `services/gateway/src/services/graph.service.ts`
- `services/gateway/src/config/graph.config.ts`

## Technical Notes

Graph API response structure:

```json
{
  "value": [
    {
      "id": "AAMkAD...",
      "displayName": "Inbox",
      "parentFolderId": "AAMkAD...",
      "childFolderCount": 2,
      "totalItemCount": 127
    }
  ]
}
```

## Session Log

- 2025-12-27: Issue created as part of Outlook Folders epic
- 2025-12-27: Implemented `getMailFolders()` method with recursive child folder fetching
