# OPS-057: Chronology Time Sections - Show All Periods

**Status:** Implementing | **Priority:** P3-Low | **Type:** UX
**Created:** 2025-12-19 | **Sessions:** 1 | **Last Active:** 2025-12-19
**Related:** OPS-051 (Time Grouping), OPS-054 (CaseChronology Integration)

## Summary

Chronology only shows time sections that have loaded events. User expects to see all time periods (AstÄƒzi, SÄƒptÄƒmÃ¢na aceasta, Luna aceasta, Mai vechi) but only "Luna aceasta" appears because loaded events are all from this month.

## Symptom

- Only "Luna aceasta" section visible with 20 events
- No "AstÄƒzi", "SÄƒptÄƒmÃ¢na aceasta", or "Mai vechi" sections
- User doesn't know if other periods have events until they load more
- Section count (20) represents loaded events, not total for that period

## Root Cause

```typescript
// timeGrouping.ts:112-123
const result: TimeGroup<T>[] = [];
for (const period of PERIOD_ORDER) {
  if (buckets[period].length > 0) {  // â† Only non-empty groups
    result.push({...});
  }
}
```

**By design but confusing:**

1. Time grouping only returns groups with events
2. Events are loaded in chronological order (most recent first)
3. First 20 events might all be from "this month"
4. Other periods' events haven't been loaded yet
5. User can't see those sections exist

## Acceptance Criteria

- [x] All time sections always visible (even if empty for that page)
- [x] Empty sections show "0" count and are visually distinct (grayed out, disabled)
- [ ] Clear indication of total events per period (not just loaded) - deferred to OPS-055
- [x] "ÃŽncarcÄƒ mai multe" at bottom, not per-section

## Implementation Options

### Option A: Show all sections, hide truly empty (Recommended)

Always render all 4 sections. Show sections that:

- Have loaded events, OR
- Might have events (based on server-side counts from OPS-055)

```typescript
// After OPS-055 provides countsByPeriod from server
const periods = ['today', 'thisWeek', 'thisMonth', 'older'];
periods.forEach((period) => {
  const loadedCount = groupedEvents[period]?.length || 0;
  const serverCount = serverCounts[period] || 0;

  if (serverCount > 0) {
    // Show section with "X of Y loaded" or just show loaded
    renderSection(period, loadedCount, serverCount);
  }
});
```

### Option B: Simple - always show all 4 sections

Even if empty, show collapsed sections:

```
â–¸ AstÄƒzi (0)
â–¸ SÄƒptÄƒmÃ¢na aceasta (0)
â–¾ Luna aceasta (20)
  [events...]
â–¸ Mai vechi (0)
```

### Option C: Progressive disclosure

Only show sections as events are loaded, but add indicator:

```
Luna aceasta (20)
[events...]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ðŸ“… Mai multe evenimente Ã®n alte perioade
[ÃŽncarcÄƒ mai multe]
```

## Dependencies

- **OPS-055** (Tab Counts) - If we want to show accurate counts per period, need server-side data
- Without OPS-055, can only show "loaded" counts

## Files to Modify

- `apps/web/src/lib/timeGrouping.ts` - Option to include empty groups
- `apps/web/src/components/case/CaseChronology.tsx` - Render empty sections
- `apps/web/src/components/case/TimeSection.tsx` - Handle empty state

## Local Verification Status

| Step           | Status     | Date | Notes |
| -------------- | ---------- | ---- | ----- |
| Prod data test | â¬œ Pending |      |       |
| Preflight      | â¬œ Pending |      |       |
| Docker test    | â¬œ Pending |      |       |

**Verified**: No

## Session Log

- [2025-12-19] Issue created via /ops-investigate. UX improvement - time sections only show loaded events
- [2025-12-19] Session 1 started. Implementing Option B (always show all 4 sections)
- [2025-12-19] Modified `timeGrouping.ts` to accept `includeEmptyPeriods` option
- [2025-12-19] Updated `TimeSection.tsx` to handle empty state (disabled button, grayed text)
- [2025-12-19] Updated `CaseChronology.tsx` to use `includeEmptyPeriods: true`
- [2025-12-19] Verified with Playwright: All 4 sections visible (AstÄƒzi, SÄƒptÄƒmÃ¢na aceasta, Luna aceasta, Mai vechi)

---
