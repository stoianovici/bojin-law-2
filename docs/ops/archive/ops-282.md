# OPS-282: Email Drafting Resolver - outlookDraftId

**Type**: Feature
**Priority**: P1-High
**Status**: Verifying
**Blocked By**: ~~OPS-279, OPS-280~~ (completed)

## Problem

`sendDraft` mutation (for AI-generated drafts) sends the email but doesn't store the Outlook draft ID on the EmailDraft record.

## Solution

1. Update `sendDraft` mutation:
   - Get draft ID from `graphService.sendMail()` response
   - Update `EmailDraft` record with `outlookDraftId`
   - Keep existing status update to "Sent" (tracks platform state, even though Outlook has it as draft)
2. Add `outlookDraftId` to EmailDraft GraphQL type

## Schema Changes

```graphql
type EmailDraft {
  # ... existing fields
  outlookDraftId: String # NEW - The ID in Outlook's draft folder
}
```

## Done When

- [x] `sendDraft` stores `outlookDraftId` on EmailDraft record
- [x] GraphQL returns `outlookDraftId` field
- [x] Existing draft workflow unchanged (status still updates to Sent)

## Files

- `services/gateway/src/graphql/resolvers/email-drafting.resolvers.ts`
- `services/gateway/src/graphql/schema/email-drafting.graphql`

## Part Of

Universal Draft Mode Epic (OPS-279 to OPS-284)

## Notes

Status remains "Sent" from the platform's perspective - this tracks that the user clicked send. The email is now in Outlook's drafts folder awaiting manual send.

## Implementation Summary

1. Added `outlookDraftId: String` field to EmailDraft GraphQL type
2. Updated `sendDraft` mutation to:
   - Import and use `GraphService` instead of direct fetch calls
   - Call `graphService.sendMail()` which respects `EMAIL_SEND_MODE` env var
   - Store the returned `draftId` (if any) in `EmailDraft.outlookDraftId`
3. Removed unused attachment fetching code (selectedAttachments was fetched but never used)
