# OPS-269: CaseDocumentsList Time Grouping

**Status**: Ready
**Type**: Feature
**Priority**: P2-Medium
**Complexity**: M
**Blocked by**: OPS-267, OPS-268

## Problem

Case documents tab shows a flat grid/list of all documents. Users with 50+ documents must scroll endlessly. No visual organization by recency.

## Approach

Wrap document grid/list in `TimePeriodSection` components:

- Use `useTimePeriodGroups` with `linkedAt` as date field
- Render one section per period containing documents for that period
- Grid view: multiple `DocumentGrid` instances (one per section)
- List view: groups of `ListDocumentCard` per section
- "Load more" moves to bottom of entire list (loads across all periods)

### Implementation Notes

```tsx
const periods = useTimePeriodGroups(gridDocuments, (doc) => new Date(doc.linkedAt));

return (
  <>
    {periods.map((period) => (
      <TimePeriodSection
        key={period.key}
        periodKey={period.key}
        label={period.label}
        count={period.items.length}
        defaultOpen={period.defaultOpen}
        storageKey={`case-docs-${caseId}`}
      >
        <DocumentGrid documents={period.items} ... />
      </TimePeriodSection>
    ))}
  </>
);
```

## Done When

- [x] Grid view shows documents grouped by time period
- [x] List view shows documents grouped by time period
- [x] Collapsing a section hides its documents
- [x] Collapse state persists per period
- [x] Empty periods are not shown
- [x] Sort still works within each period

## Files

- `apps/web/src/components/case/CaseDocumentsList.tsx` (modify)

## Session Log

### 2025-12-26

Implemented time period grouping for CaseDocumentsList:

1. Added imports for `useTimePeriodGroups` hook and `TimePeriodSection` component
2. Used `useTimePeriodGroups` to group grid documents by `linkedAt` date
3. Used `useTimePeriodGroups` to group list documents by `linkedAt` date
4. Replaced `DocumentGrid` component with inline rendering that wraps each period's documents in `TimePeriodSection`
5. Each section uses the pattern: `storageKey={case-docs-grid-${caseId}}` or `storageKey={case-docs-list-${caseId}}` for localStorage persistence
6. Kept sort dropdown functional at the top level (documents are sorted before grouping)
7. "Load more" button remains at the bottom of the entire list

Key changes to `CaseDocumentsList.tsx`:

- Import `useTimePeriodGroups` and `TimePeriodSection`
- Import `DocumentCard` directly instead of `DocumentGrid`
- Added `gridPeriods` and `listPeriods` computed from `useTimePeriodGroups`
- Grid view: Renders `TimePeriodSection` for each period, containing a grid of `DocumentCard` components
- List view: Renders `TimePeriodSection` for each period, containing `ListDocumentCard` components
- Both views have loading, empty, and error states handled
