# OPS-242: AI Ops Dashboard Layout & Overview

**Type**: Feature
**Priority**: P2-Medium
**Status**: Completed
**Epic**: AI Batch Processing & Ops Dashboard

## Problem

No UI for viewing AI costs and system status. Partners have no visibility into AI spend.

## Solution

Create `/admin/ai-ops` route with overview dashboard showing key metrics and trends.

### Layout Structure

```
/admin/ai-ops/
├── layout.tsx      # Admin nav sidebar
├── page.tsx        # Overview dashboard (default)
├── features/       # OPS-243
├── costs/          # OPS-244
├── history/        # OPS-245
└── budget/         # OPS-246
```

### Admin Navigation

```tsx
const navItems = [
  { href: '/admin/ai-ops', label: 'Prezentare generală', icon: LayoutDashboard },
  { href: '/admin/ai-ops/features', label: 'Funcționalități', icon: ToggleLeft },
  { href: '/admin/ai-ops/costs', label: 'Costuri', icon: DollarSign },
  { href: '/admin/ai-ops/history', label: 'Istoric', icon: History },
  { href: '/admin/ai-ops/budget', label: 'Buget', icon: PiggyBank },
];
```

### Overview Page Components

1. **Stat Cards Row**
   - Total cost (this month)
   - Total tokens used
   - API calls made
   - Success rate %

2. **Cost Trend Chart**
   - Line chart showing daily spend (last 30 days)
   - Compare to budget line if set

3. **Budget Progress**
   - Progress bar showing spend vs limit
   - Projected month-end estimate

4. **Quick Feature Status**
   - List of features with on/off indicators
   - Last run time for batch processors

### Auth Check

```tsx
// layout.tsx
'use client';

import { useAuth } from '@/lib/hooks/useAuth';
import { useRouter } from 'next/navigation';
import { useEffect } from 'react';

export default function AIAdminLayout({ children }: { children: React.ReactNode }) {
  const { user, loading } = useAuth();
  const router = useRouter();

  useEffect(() => {
    if (!loading && (!user || user.role !== 'Partner')) {
      router.push('/dashboard');
    }
  }, [user, loading, router]);

  // Show loading state while checking auth
  if (loading) {
    return (
      <div className="flex min-h-screen items-center justify-center">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary" />
      </div>
    );
  }

  // Don't render if not authorized (redirect will happen)
  if (!user || user.role !== 'Partner') {
    return null;
  }

  return (
    <div className="flex min-h-screen">
      <AdminSidebar />
      <main className="flex-1 p-6">{children}</main>
    </div>
  );
}
```

## Acceptance Criteria

- [ ] `/admin/ai-ops` route with Partner auth check
- [ ] Admin layout with sidebar navigation
- [ ] 4 stat cards with real data from GraphQL
- [ ] Cost trend line chart (using recharts)
- [ ] Budget progress bar
- [ ] Feature status quick view
- [ ] Responsive layout (works on tablet+)
- [ ] Dark mode support

## Files to Modify

- `apps/web/src/app/admin/ai-ops/layout.tsx` (new)
- `apps/web/src/app/admin/ai-ops/page.tsx` (new)
- `apps/web/src/components/admin/AdminSidebar.tsx` (new)
- `apps/web/src/components/admin/StatCard.tsx` (new)
- `apps/web/src/components/admin/CostTrendChart.tsx` (new)
- `apps/web/src/components/admin/BudgetProgress.tsx` (new)
- `apps/web/src/hooks/useAIUsage.ts` (new)

## Dependencies

- OPS-241 (GraphQL schema must exist)

## Parallel Work

Can be done in parallel with OPS-243, OPS-244, OPS-245, OPS-246.

## Implementation Notes

### Files Created

- `apps/web/src/app/admin/ai-ops/layout.tsx` - Admin layout with sidebar navigation and Partner-only auth check
- `apps/web/src/app/admin/ai-ops/page.tsx` - Overview dashboard page with stat cards, chart, and feature status
- `apps/web/src/hooks/useAIOps.ts` - GraphQL hooks for AI ops data
- `apps/web/src/components/admin/StatCard.tsx` - Reusable stat card component
- `apps/web/src/components/admin/CostTrendChart.tsx` - Line chart for daily costs with recharts
- `apps/web/src/components/admin/BudgetProgress.tsx` - Budget progress bar with projections
- `apps/web/src/components/admin/FeatureStatusList.tsx` - Feature status list with on/off indicators

### Files Modified

- `apps/web/src/components/layout/TopBar.tsx` - Added "Operațiuni AI" link in Partner dropdown menu

### Features Implemented

- Partner-only authentication check with redirect
- Admin sidebar navigation with 5 sections
- 4 stat cards: Cost, Tokens, API Calls, Success Rate
- Cost trend line chart (last 30 days)
- Budget progress bar with projected spend
- Request features list with daily cost estimates
- Batch features list with last run status
- Quick actions links to sub-pages
- Full Romanian localization
- Responsive layout (works on tablet+)
- Dark mode support (via Tailwind)

### Access

Partners can access via user dropdown menu → "Operațiuni AI" or directly at `/admin/ai-ops`
