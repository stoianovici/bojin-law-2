# OPS-105: SharePoint Site Configuration

| Field        | Value                                       |
| ------------ | ------------------------------------------- |
| **Status**   | Fixed                                       |
| **Type**     | Infrastructure                              |
| **Priority** | P0-Critical                                 |
| **Created**  | 2025-12-22                                  |
| **Blocked**  | None                                        |
| **Blocks**   | OPS-106, OPS-107, OPS-108, OPS-109, OPS-110 |

## Description

Create and configure a SharePoint site to serve as the centralized document storage for all firm cases. This replaces the current personal OneDrive storage approach which has fundamental permission limitations (delegated permissions cannot access other users' drives).

## Why SharePoint?

Personal OneDrive with `Files.Read.All` delegated permission does NOT grant access to other users' files. Only the document uploader can preview their own documents. SharePoint sites use site-level permissions where all members can access all documents.

## Tasks

- [ ] Create Team Site in SharePoint Admin Center
  - Site name: `Documente FirmÄƒ`
  - URL: `bojinlucian.sharepoint.com/sites/documente-firma`
  - Privacy: Private
- [ ] Add all firm users as site members
- [ ] Create base folder structure:
  - `/Cases/` - for case documents
  - `/Templates/` - for document templates (optional)
- [ ] Capture configuration values:
  - `SHAREPOINT_SITE_ID` - the site's Graph ID
  - `SHAREPOINT_DRIVE_ID` - the document library's drive ID
- [ ] Document the configuration in `.env.example`

## Getting Site and Drive IDs

After creating the site, use Graph Explorer or this API call:

```
GET https://graph.microsoft.com/v1.0/sites/bojinlucian.sharepoint.com:/sites/documente-firma
```

Response includes `id` (site ID). Then:

```
GET https://graph.microsoft.com/v1.0/sites/{siteId}/drive
```

Response includes `id` (drive ID).

## Environment Variables

```env
SHAREPOINT_SITE_ID=bojinlucian.sharepoint.com,guid,guid
SHAREPOINT_DRIVE_ID=b!xxxxxxxxxxxxx
```

## Acceptance Criteria

1. SharePoint site exists and is accessible
2. All current firm users are members
3. Site ID and Drive ID are captured
4. Environment variables documented

## Captured Configuration

```env
SHAREPOINT_SITE_ID=bojinlucian.sharepoint.com,8d29d150-0028-4f5e-8d77-5aa8aa0d1d14,d9f4648d-38b2-4cab-a004-6e98af641e0f
SHAREPOINT_DRIVE_ID=b!UNEpjSgAXk-Nd1qoqg0dFI1k9NmyOKtMoARumK9kHg-1_xz1h-dOQpwhUVHfVa0L
```

**Site URL**: https://bojinlucian.sharepoint.com/sites/documentefirma
**Drive Name**: Documente (Documente partajate)
**Quota**: ~25TB available

## Session Log

- [2025-12-22] Issue created. User is in SharePoint Admin Center creating team site.
- [2025-12-22] SharePoint site "Documente Firma" created and configured.
- [2025-12-22] Site ID and Drive ID captured via Graph Explorer. OPS-105 complete.
