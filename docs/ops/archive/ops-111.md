# OPS-111: Document Grid UI with Thumbnails

| Field        | Value      |
| ------------ | ---------- |
| **Status**   | Verifying  |
| **Type**     | Feature    |
| **Priority** | P2-Medium  |
| **Created**  | 2025-12-22 |
| **Blocked**  | None       |
| **Blocks**   | None       |

## Description

Create a new document grid view that displays documents as cards with large first-page thumbnails, 2 per row. This provides much better visibility of document content compared to the current list view with generic icons.

## Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                           â”‚  â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚                           â”‚  â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚    First Page Preview     â”‚  â”‚  â”‚  â”‚    First Page Preview     â”‚  â”‚
â”‚  â”‚    (800px thumbnail)      â”‚  â”‚  â”‚  â”‚    (800px thumbnail)      â”‚  â”‚
â”‚  â”‚                           â”‚  â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚                           â”‚  â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚  â”‚                                 â”‚
â”‚  Contract.pdf                   â”‚  â”‚  Amendment.docx                 â”‚
â”‚  Dosar 123/2024 â€¢ 2.4 MB        â”‚  â”‚  Dosar 123/2024 â€¢ 156 KB        â”‚
â”‚  ÃŽncÄƒrcat: 15 dec 2024          â”‚  â”‚  ÃŽncÄƒrcat: 18 dec 2024          â”‚
â”‚                                 â”‚  â”‚                                 â”‚
â”‚  [ðŸ‘ Previzualizare] [â†“ DescarcÄƒ] â”‚  â”‚  [ðŸ‘ Previzualizare] [â†“ DescarcÄƒ] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Components

### DocumentGrid.tsx

```tsx
interface DocumentGridProps {
  documents: Document[];
  onPreview: (doc: Document) => void;
  onDownload: (doc: Document) => void;
  loading?: boolean;
}

export function DocumentGrid({ documents, onPreview, onDownload, loading }: DocumentGridProps) {
  return (
    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
      {documents.map((doc) => (
        <DocumentCard
          key={doc.id}
          document={doc}
          onPreview={() => onPreview(doc)}
          onDownload={() => onDownload(doc)}
        />
      ))}
    </div>
  );
}
```

### DocumentCard.tsx

```tsx
interface DocumentCardProps {
  document: Document;
  onPreview: () => void;
  onDownload: () => void;
}

export function DocumentCard({ document, onPreview, onDownload }: DocumentCardProps) {
  return (
    <Card className="overflow-hidden">
      {/* Thumbnail area - 16:9 aspect ratio */}
      <div className="aspect-[4/3] bg-gray-100 relative">
        {document.thumbnailLarge ? (
          <img
            src={document.thumbnailLarge}
            alt={document.fileName}
            className="w-full h-full object-contain"
          />
        ) : (
          <div className="flex items-center justify-center h-full">
            <FileIcon className="w-16 h-16 text-gray-400" />
          </div>
        )}
      </div>

      {/* Document info */}
      <div className="p-4">
        <h3 className="font-medium text-gray-900 truncate">{document.fileName}</h3>
        <p className="text-sm text-gray-500 mt-1">
          {document.case?.caseNumber} â€¢ {formatFileSize(document.fileSize)}
        </p>
        <p className="text-sm text-gray-400">ÃŽncÄƒrcat: {formatDate(document.createdAt)}</p>

        {/* Actions */}
        <div className="flex gap-2 mt-4">
          <Button variant="outline" size="sm" onClick={onPreview}>
            <Eye className="w-4 h-4 mr-1" />
            Previzualizare
          </Button>
          <Button variant="outline" size="sm" onClick={onDownload}>
            <Download className="w-4 h-4 mr-1" />
            DescarcÄƒ
          </Button>
        </div>
      </div>
    </Card>
  );
}
```

### useDocumentGrid.ts Hook

```tsx
export function useDocumentGrid(caseId?: string) {
  const { data, loading, error, fetchMore } = useQuery(GET_CASE_DOCUMENTS_GRID, {
    variables: { caseId, first: 20 },
    skip: !caseId,
  });

  return {
    documents: data?.caseDocumentsGrid?.edges?.map((e) => e.node) ?? [],
    loading,
    error,
    hasMore: data?.caseDocumentsGrid?.pageInfo?.hasNextPage,
    loadMore: () =>
      fetchMore({ variables: { after: data?.caseDocumentsGrid?.pageInfo?.endCursor } }),
  };
}
```

## Integration Points

1. **Case Documents Tab** - Replace list view with grid
2. **/documents page** - Add grid view toggle
3. **AI Assistant** - Show document cards in responses

## Files Affected

**New:**

- `apps/web/src/components/documents/DocumentGrid.tsx`
- `apps/web/src/components/documents/DocumentCard.tsx`
- `apps/web/src/hooks/useDocumentGrid.ts`

**Modified:**

- `apps/web/src/components/case/CaseDocumentsList.tsx` - Use DocumentGrid
- `apps/web/src/app/documents/page.tsx` - Add grid view option

## Acceptance Criteria

1. Documents display as cards, 2 per row on desktop
2. Cards show large first-page thumbnail (800px)
3. Fallback to file icon if thumbnail unavailable
4. Card shows: filename, case number, size, date
5. Preview and download buttons on each card
6. Responsive: 1 column on mobile, 2 on desktop
7. Loading skeleton while thumbnails load

## Parallelization

Can be developed in parallel with backend (OPS-106, OPS-107):

- Use mock data initially
- Connect to real API when available

## Session Log

- [2025-12-22] Issue created as part of SharePoint migration epic.
- [2025-12-22] Session 1: Implemented document grid UI
  - Created `useDocumentGrid.ts` hook with pagination and sorting support
  - Created `DocumentCard.tsx` component with thumbnail display, status badges, storage indicator
  - Created `DocumentGrid.tsx` container with sort dropdown, infinite scroll
  - Updated `CaseDocumentsList.tsx` with list/grid view toggle
  - Updated `caseDocumentsGrid` resolver to fetch thumbnails from SharePoint
  - Tested with production data - 330 documents displayed correctly in grid
  - Screenshot saved: `.playwright-mcp/document-grid-view.png`
