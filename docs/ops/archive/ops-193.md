# OPS-193: Personal Contacts Profile Page

**Status:** Resolved | **Priority:** P2-Medium | **Type:** Feature | **Created:** 2025-12-24

## Overview

Add a section to user profile for viewing and managing personal contact blocklist.

## Dependencies

- **Depends on:** OPS-190 (service + GraphQL)
- **Blocks:** None
- **Parallel with:** OPS-194, OPS-195, OPS-196

## Context

Part of Communications UX Overhaul epic. Once users mark senders as "personal", they need a place to view this list and optionally remove contacts to re-enable email sync from them.

## Requirements

### 1. Profile Section Location

Add to `/profile` page or `/settings`:

```
┌─────────────────────────────────────────────────────────┐
│  Profil                                                 │
├─────────────────────────────────────────────────────────┤
│  ... existing profile sections ...                      │
│                                                         │
│  ─────────────────────────────────────────────────────  │
│                                                         │
│  Contacte personale                                     │
│  Emailurile de la aceste adrese nu vor fi sincronizate  │
│                                                         │
│  ┌───────────────────────────────────────────────────┐  │
│  │  mama@gmail.com                   [Reclasifică ↺] │  │
│  │  newsletter@company.ro            [Reclasifică ↺] │  │
│  │  spam.sender@example.com          [Reclasifică ↺] │  │
│  └───────────────────────────────────────────────────┘  │
│                                                         │
│  Nicio adresă de email personală                        │
│  (empty state)                                          │
└─────────────────────────────────────────────────────────┘
```

### 2. Hook

```typescript
function usePersonalContacts() {
  const { data, loading, error, refetch } = useQuery(GET_PERSONAL_CONTACTS);
  const [removeContact] = useMutation(REMOVE_PERSONAL_CONTACT);

  const handleRemove = async (email: string) => {
    await removeContact({ variables: { email } });
    refetch();
  };

  return {
    contacts: data?.personalContacts ?? [],
    loading,
    error,
    removeContact: handleRemove,
  };
}
```

### 3. UI Components

- Section header with description
- List of email addresses
- "Reclasifică" button (removes from list)
- Confirmation dialog before removal
- Empty state when no personal contacts
- Loading skeleton

### 4. Romanian Text

- Header: "Contacte personale"
- Description: "Emailurile de la aceste adrese nu vor fi sincronizate"
- Button: "Reclasifică"
- Empty: "Nicio adresă de email personală"
- Confirm: "Sigur doriți să reclasificați acest contact? Emailurile viitoare vor fi sincronizate."

## Acceptance Criteria

- [x] Section visible in profile/settings
- [x] Lists all personal contacts
- [x] "Reclasifică" removes from list
- [x] Confirmation before removal
- [x] Empty state handled
- [x] Loading state with skeleton
- [x] Romanian text throughout
- [x] Refetches after removal

## Files to Create/Modify

- `apps/web/src/app/profile/page.tsx` (MODIFY)
- `apps/web/src/hooks/usePersonalContacts.ts` (NEW)
- `apps/web/src/components/profile/PersonalContactsSection.tsx` (NEW)

## Estimated Scope

Small - Simple list UI with CRUD.

---

## Session Log

### Session 1 - 2025-12-24

**Completed:**

- Created `usePersonalContacts` hook (`apps/web/src/hooks/usePersonalContacts.ts`)
- Created `PersonalContactsSection` component (`apps/web/src/components/settings/PersonalContactsSection.tsx`)
- Added "Contacte" tab to `SettingsTabBar` component
- Integrated `ContactsContent` into unified Settings page (`/settings/billing?tab=contacts`)

**Implementation Notes:**

- Used existing pattern from `usePersonalSnippets` for hook structure
- Component follows same design patterns as `GlobalEmailSourcesPanel`
- Added lucide-react icons (UserX, RefreshCcw, Mail, Trash2, AlertCircle, Inbox)
- Romanian text throughout as per conventions
- Two-step confirmation for removal (click "Reclasifică" → click "Confirmă")
- Info box explaining that old emails won't be recovered

**Files Created:**

- `apps/web/src/hooks/usePersonalContacts.ts`
- `apps/web/src/components/settings/PersonalContactsSection.tsx`

**Files Modified:**

- `apps/web/src/components/settings/SettingsTabBar.tsx` (added 'contacts' tab)
- `apps/web/src/app/settings/billing/page.tsx` (added ContactsContent and tab handling)
