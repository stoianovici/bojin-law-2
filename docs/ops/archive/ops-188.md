# OPS-188: SplitAssignmentButton Component

**Status:** Closed | **Priority:** P1-High | **Type:** Feature | **Created:** 2025-12-24

## Overview

Create a split button component for inline email-to-case assignment, replacing the ClassificationModal approach.

## Dependencies

- **Depends on:** None (pure UI component)
- **Blocks:** OPS-195, OPS-196
- **Parallel with:** OPS-187, OPS-189

## Context

Part of Communications UX Overhaul epic. NECLAR emails should show inline assignment buttons instead of opening a modal. The button has an 80/20 split between primary and secondary suggestions, with confidence indicated by color.

## Requirements

### 1. Component Interface

```tsx
interface CaseSuggestion {
  id: string;
  title: string;
  confidence: number; // 0.0 - 1.0
}

interface SplitAssignmentButtonProps {
  primaryCase: CaseSuggestion;
  secondaryCase?: CaseSuggestion;
  allSuggestions?: CaseSuggestion[]; // For dropdown
  onAssign: (caseId: string) => void;
  onPersonal?: () => void; // Mark sender as personal
  loading?: boolean;
  disabled?: boolean;
}
```

### 2. Visual Design

```
┌────────────────────────────────┬──────────┐
│  Adaugă: Popescu v. Ionescu    │ SC Alpha │
│         [CYAN background]      │  [YELLOW]│
└────────────────────────────────┴──────────┘
        ~80% width                 ~20% width
```

### 3. Color Coding

Confidence levels mapped to colors:

- **Cyan** (`#06b6d4`): High confidence (70%+)
- **Yellow** (`#eab308`): Medium confidence (40-69%)
- **Magenta** (`#d946ef`): Low confidence (<40%)

### 4. Interactions

- Click primary → calls `onAssign(primaryCase.id)`
- Click secondary → expands dropdown with all suggestions
- Dropdown items show confidence percentage
- Optional "Personal" button alongside

### 5. States

- Default: Shows primary + secondary
- Loading: Spinner, disabled clicks
- Expanded: Dropdown visible with all options
- Single suggestion: Full width, no split

## Acceptance Criteria

- [ ] Component renders 80/20 split layout
- [ ] Confidence colors applied correctly (cyan/yellow/magenta)
- [ ] Primary click triggers onAssign
- [ ] Secondary click shows dropdown
- [ ] Dropdown shows all suggestions with confidence %
- [ ] Loading state disables interaction
- [ ] Single suggestion = full width
- [ ] Storybook story with all variants
- [ ] No TypeScript errors

## Files to Create

- `apps/web/src/components/communication/SplitAssignmentButton.tsx`
- `apps/web/src/components/communication/SplitAssignmentButton.stories.tsx`

## Estimated Scope

Medium - Standalone component with multiple states.

---

## Session Log

### Session 2025-12-24

**Completed:**

1. Created `SplitAssignmentButton.tsx` with:
   - 80/20 split layout for primary/secondary suggestions
   - Confidence-based color coding (cyan/yellow/magenta)
   - Dropdown for all suggestions with "Contact personal" option
   - Single-suggestion full-width variant
   - Loading and disabled states
   - Outside-click-to-close dropdown behavior

2. Created `SplitAssignmentButton.stories.tsx` with:
   - All confidence levels (high/medium/low)
   - Single suggestion variant
   - With personal option
   - Loading and disabled states
   - Long titles truncation demo
   - Interactive demo with state management
   - AllConfidenceLevels and AllStates comparison views

**Files Created:**

- `apps/web/src/components/communication/SplitAssignmentButton.tsx`
- `apps/web/src/components/communication/SplitAssignmentButton.stories.tsx`

**Status:** All acceptance criteria met, TypeScript passes.
